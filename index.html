<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Votação BBB Style</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      margin: 0;
      padding: 0;
    }
    header {
      background: #d6001c;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
    }
    main {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(200px,1fr));
      gap: 20px;
    }
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
      padding: 15px;
      text-align: center;
    }
    .card img {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 10px;
    }
    .card button {
      background: #d6001c;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    .card button:hover {
      background: #b00018;
    }
    /* popup */
    .popup {
      position: fixed;
      top:0;left:0;
      width:100%;height:100%;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,0.6);
      z-index:9999;
    }
    .popup-content {
      background:#fff;
      padding:20px;
      border-radius:16px;
      text-align:center;
      box-shadow:0px 4px 12px rgba(0,0,0,0.3);
      animation: fadeInOut 3s ease forwards;
    }
    .popup-content img {
      margin-top:10px;
      width:120px;
      height:120px;
      border-radius:12px;
      object-fit:cover;
    }
    @keyframes fadeInOut {
      0% {opacity:0; transform:scale(0.9);}
      10% {opacity:1; transform:scale(1);}
      90% {opacity:1;}
      100% {opacity:0; transform:scale(0.9);}
    }
    /* admin */
    #admin-panel {
      display:none;
      padding:20px;
      background:#f5f5f5;
      border-top:3px solid #d6001c;
    }
    #admin-panel h2 { margin-top:0; }
    table {
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
    }
    table, th, td {
      border:1px solid #ccc;
    }
    th, td {
      padding:8px;
      text-align:center;
    }
    .hidden {display:none;}
    #final-screen {
      display:none;
      position:fixed;
      top:0;left:0;
      width:100%;height:100%;
      background:white;
      z-index:10000;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      text-align:center;
    }
    #final-screen img {
      width:200px;
      border-radius:12px;
      margin:20px 0;
    }
  </style>
</head>
<body>
  <header>Sistema de Votação BBB Style</header>
  
  <main id="participants"></main>

  <!-- popup -->
  <div id="popup" class="popup">
    <div class="popup-content">
      <h2>Voto Confirmado</h2>
      <img id="popup-img" src="" alt="Foto do participante">
    </div>
  </div>

  <!-- admin login -->
  <div style="padding:20px;">
    <input type="password" id="admin-pass" placeholder="Senha Admin">
    <button onclick="loginAdmin()">Entrar Admin</button>
  </div>

  <!-- painel admin -->
  <div id="admin-panel">
    <h2>Painel Admin</h2>
    <button onclick="resetarVotacao()">Resetar Votação</button>
    <button onclick="exportarDados()">Exportar Dados</button>
    <button onclick="encerrarVotacao()">Encerrar Votação</button>
    <br><br>
    <h3>Alterar Senha</h3>
    <input type="password" id="nova-senha" placeholder="Nova senha">
    <button onclick="alterarSenha()">Alterar</button>

    <h3>Adicionar Participante</h3>
    <input type="text" id="novo-nome" placeholder="Nome">
    <input type="text" id="nova-foto" placeholder="URL da foto">
    <button onclick="adicionarParticipante()">Adicionar</button>

    <h3>Estatísticas</h3>
    <table id="tabela-admin">
      <thead>
        <tr><th>Nome</th><th>Votos</th><th>%</th><th>Ações</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- tela final -->
  <div id="final-screen">
    <h1>Resultado Final</h1>
    <h2 id="eliminado-nome"></h2>
    <img id="eliminado-foto" src="">
    <h3 id="estatisticas-finais"></h3>
    <button onclick="resetarVotacao()">Reiniciar</button>
  </div>

<script>
let participantes = JSON.parse(localStorage.getItem("participantes")) || [
  {id:1,nome:"Ana",foto:"https://picsum.photos/id/1011/300/300",votos:0},
  {id:2,nome:"Bruno",foto:"https://picsum.photos/id/1012/300/300",votos:0},
  {id:3,nome:"Carla",foto:"https://picsum.photos/id/1013/300/300",votos:0}
];
let adminSenha = localStorage.getItem("adminSenha") || "1234";

function salvar() {
  localStorage.setItem("participantes",JSON.stringify(participantes));
}

function renderParticipantes() {
  const container=document.getElementById("participants");
  container.innerHTML="";
  participantes.forEach(p=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <img src="${p.foto}">
      <h3>${p.nome}</h3>
      <button onclick="registrarVoto(${p.id})">Votar</button>
    `;
    container.appendChild(card);
  });
  atualizarTabelaAdmin();
}

function registrarVoto(id) {
  const p=participantes.find(x=>x.id===id);
  p.votos++;
  salvar();
  confirmarVoto(p.foto);
}

function confirmarVoto(foto){
  const popup=document.getElementById("popup");
  const popupImg=document.getElementById("popup-img");
  popupImg.src=foto;
  popup.style.display="flex";
  setTimeout(()=>popup.style.display="none",3000);
}

function loginAdmin(){
  const pass=document.getElementById("admin-pass").value;
  if(pass===adminSenha){
    document.getElementById("admin-panel").style.display="block";
  } else {
    alert("Senha incorreta!");
  }
}

function atualizarTabelaAdmin(){
  const tbody=document.querySelector("#tabela-admin tbody");
  tbody.innerHTML="";
  const total=participantes.reduce((a,b)=>a+b.votos,0);
  participantes.forEach((p,i)=>{
    const tr=document.createElement("tr");
    const perc=total?((p.votos/total)*100).toFixed(1):0;
    tr.innerHTML=`
      <td>${p.nome}</td>
      <td>${p.votos}</td>
      <td>${perc}%</td>
      <td><button onclick="removerParticipante(${p.id})">Remover</button></td>
    `;
    tbody.appendChild(tr);
  });
}

function adicionarParticipante(){
  const nome=document.getElementById("novo-nome").value;
  const foto=document.getElementById("nova-foto").value;
  if(nome && foto){
    participantes.push({id:Date.now(),nome,foto,votos:0});
    salvar();
    renderParticipantes();
  }
}

function removerParticipante(id){
  participantes=participantes.filter(p=>p.id!==id);
  salvar();
  renderParticipantes();
}

function resetarVotacao(){
  participantes.forEach(p=>p.votos=0);
  salvar();
  renderParticipantes();
  document.getElementById("final-screen").style.display="none";
}

function alterarSenha(){
  const nova=document.getElementById("nova-senha").value;
  if(nova){
    adminSenha=nova;
    localStorage.setItem("adminSenha",nova);
    alert("Senha alterada!");
  }
}

function exportarDados(){
  const dados=JSON.stringify(participantes);
  const blob=new Blob([dados],{type:"application/json"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url;a.download="dados.json";a.click();
  URL.revokeObjectURL(url);
}

function encerrarVotacao(){
  const total=participantes.reduce((a,b)=>a+b.votos,0);
  if(!total){alert("Nenhum voto ainda!");return;}
  const eliminado=participantes.reduce((max,p)=>p.votos>max.votos?p:max,participantes[0]);
  document.getElementById("eliminado-nome").textContent=eliminado.nome;
  document.getElementById("eliminado-foto").src=eliminado.foto;
  let est="";
  participantes.forEach(p=>{
    const perc=((p.votos/total)*100).toFixed(1);
    est+=`${p.nome}: ${p.votos} votos (${perc}%)\n`;
  });
  document.getElementById("estatisticas-finais").textContent=est;
  document.getElementById("final-screen").style.display="flex";
}

renderParticipantes();
</script>
</body>
</html>
